# Numerical Simulation of Complex Stochastic Optimal Control for a Relativistic Electron in a Constant Magnetic Field (Dirac–Landau)

This repository presents a simulation study of **complex stochastic optimal control (SOC)** for a relativistic electron in a constant magnetic field (the **Dirac–Landau** problem). We compare the **ensemble-averaged action** under the analytically optimal control to nearby controls generated by small **mass-shell–tangent complex four-kicks**, and visualize how the expected action changes with “distance” from the optimum.

## Figures

- **n = 0** (ground Landau level)  
  ![n=0: ΔRe(S) vs policy distance](fig/n0_action_vs_distance.png)

- **n = 1** (first excited Landau level)  
  ![n=1: ΔRe(S) vs policy distance](fig/n1_action_vs_distance.png)

Each figure shows a scatter of (R, ΔRe(S)) for many nearby policies and a **binned mean ± 1.96·SE** curve. For each bin in R, the **optimal baseline** (expected action at the optimal control) is recomputed with independent randomness.

## What is plotted

**Vertical axis (action gap)**  
ΔRe(S) = E[S]_policy − E[S]_optimal.

**Horizontal axis (policy distance)**  
R = (1/N_t) · Σ_k sqrt(|δ_k^T η δ_k|) / c, with η = diag(1,−1,−1,−1),  
where δ_k is the complex four-kick at step k and c is the speed of light. **R is dimensionless** (a fraction of c).

**Key observation:** for both n = 0 and n = 1, the **optimal policy** sits at (R = 0, ΔRe(S) = 0). As policies move away (larger R), the binned mean of ΔRe(S) rises, confirming **local optimality of the action** in this complex SOC setting.

## Method (brief)

- The **optimal control** w*(k) at each time step uses the Dirac–Landau structure:
  - time component from the Landau-level energy shift,
  - spatial “quantum drift” Q_sp = (i·ħ/m) · ∂_x ln ψ_n(x),
  - EM entries from the Landau-gauge vector potential.
- Nearby controls are formed by adding small **complex four-kicks** δ_k that are **projected tangent to the mass shell** (first-order admissibility): w*^T η δ_k = 0. Each kick is scaled by its Minkowski norm to achieve a target size.
- Dynamics are integrated with **Euler–Maruyama**, and the action is averaged over an **ensemble** of trajectories. Optimal baselines and policies use **independent seeds**. All runs use the **same initial position** x₀ for a given n.

## How to reproduce

1. Open `complex_soc_dirac_landau.m` in MATLAB/Octave.
2. Set physics/grid: `n`, `s`, `B`, `Nt`, `T`.
3. Choose policy generation and binning parameters:
   - `N_policies`, `N_policy_repeats`, `N_steps_kicked`, `max_kick`, `disp_frac`
   - `N_bins` (for the binned baseline curve)
4. Run. The script writes figures to `fig/` (e.g., `fig/n0_action_vs_distance.png`, `fig/n1_action_vs_distance.png`).

## Files

- `complex_soc_dirac_landau.m` — main script producing the figures above (supports n = 0, 1).
- Helper routines (defined at the end of the script):
  - `phys_constants()`
  - `grad_ln_wave_function(n,x,lB)` (currently n = 0, 1)
  - `landau_energy_shift(n,s,C,omega_c)`

## Extending beyond n = 1

To add n = 2, 3, extend `grad_ln_wave_function` using the Hermite-polynomial identity
∂_x ln ψ_n(x) = (2n/ℓ_B) · H_{n−1}(x/ℓ_B) / H_n(x/ℓ_B) − x/ℓ_B²,  with  ℓ_B = sqrt(ħ/|e|B),
using numerically stable Hermite evaluations and guards at zeros of H_n. The rest of the pipeline (controls, distance metric, averaging) is unchanged.

## Notes

- R is **dimensionless** (fraction of c).
- Vertical axis shows ΔRe(S).

## License

MIT (suggested).

## Citation

